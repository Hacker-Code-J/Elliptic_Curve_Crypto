\newpage
\section{Multi-Precision Multiplication}
\begin{note}[\bf Memory for the Multiplication] Let $X$ and $Y$ are $n$-word and $m$-word strings, \ie, \[
X\in\intco{2^{w(n-1)},2^{wn}},\quad
Y\in\intco{2^{w(m-1)},2^{wm}}
\] Then
\[\len_\word(XY)\in\set{n+m-1, n+m}, \ie, XY\in\intco{2^{w(n+m-1)},2^{w(n+m)}}.
\]
\begin{proof}
	Since \begin{align*}
		2^{w(n-1)}\cdot 2^{w(m-1)}\leq&\ X\cdot Y<2^{wn}\cdot 2^{wm},\\
		2^{w(n+m-2)}\leq&\ XY<2^{w(n+m)},
	\end{align*} we have $XY\in\intco{2^{w(n+m-2)}, 2^{w(n+m)}}=\intco{2^{w(n+m-2)}, 2^{w(n+m-1)}}\cup\intco{2^{w(n+m-1)}, 2^{w(n+m)}}$. Thus, either \[
	\len_\word(XY)=n+m-1\quad\text{or}\quad\len_\word(XY)=n+m.
	\]
\end{proof}
\end{note}

\begin{note}[Single-Word Multiplication]
\ \begin{table}[h!]\centering\renewcommand{\arraystretch}{1.25}
{\ttfamily\footnotesize\begin{tabular*}{\textwidth}{@{\extracolsep{\fill}}cccc}
&&& 570D:C5EE\\
$\times$ &&& 4857:A994\\ 
\cline{1-4}
& (C5EE*A994)$\ll 00/2$ = &   & 831C:8B98 \\
+&(570D*A994)$\ll 32/2$ = &   0000:39A9 & E884:0000 \\
+&(4847*C5EE)$\ll 32/2$ = &   0000:37E1 & D502:0000 \\
+&(570D*4847)$\ll 32/1$ = &   1893:CC9B & 0000:0000 \\
\cline{1-4}
& & 1899:AF03 & 9F82:8B98
\end{tabular*}}
\end{table}\\
\noindent Note that \[
u,v\in\intco{0,2^{w/2}}\implies uv\in\intco{0,2^w}.
\]
Let $x,y\in\intco{0, 2^w}$ satisfy the followings: \[
x = x_12^{w/2}+x_0,\quad
y = y_12^{w/2}+y_0
\]
The product $xy\in\intco{0,2^{2w}}$ can be calculated using four $w/2$-bit integer multiplication operations:
\begin{center}
\begin{minipage}{.6\textwidth}\centering
\begin{tabular}{|c|c|c|c|}
\multicolumn{2}{l}{} & \multicolumn{2}{l}{$x_1:x_0$}\\
\multicolumn{2}{l}{$\times$} & \multicolumn{2}{l}{$y_1:y_0$} \\ \specialrule{1.5pt}{1pt}{1pt}
\hline
\hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_0y_0$}\\ \hline
& \multicolumn{2}{c|}{$x_1y_0$} & \hspace{10pt} \\ \hline
& \multicolumn{2}{c|}{$y_1x_0$} & ~ \\ \hline
\multicolumn{2}{|c|}{$x_1y_1$} & \hspace{15pt} & ~ \\ \hline
\end{tabular}
\end{minipage}
\begin{minipage}{.25\textwidth}
\begin{align*}
xy&=(x_12^{w/2}+x_0)(y_12^{w/2}+y_0)\\
&=(x_1y_1)2^w + x_0y_0 + (x_1y_0 + y_1x_0)2^{w/2}\\
&=((x_1y_2\ll w) + x_0y_0) + ((x_1y_0 + y_1x_0)\ll w/2).
\end{align*}
\end{minipage}
\end{center}
\end{note}

\subsection{Operand Scanning (School Book)}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\multicolumn{2}{c}{} & \multicolumn{2}{c}{} & \multicolumn{2}{c||}{$x_{11}:x_{10}$} & \multicolumn{2}{c}{$x_{01}:x_{00}$} \\
\multicolumn{2}{l}{$\times$} & \multicolumn{2}{c}{} & \multicolumn{2}{c||}{$y_{11}:y_{10}$} & \multicolumn{2}{c}{$y_{01}:y_{00}$} \\ \specialrule{1.5pt}{1pt}{1pt}
\hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{00}y_{00}$}\\ \hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{01}y_{00}$} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{10}y_{00}$} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{11}y_{00}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline\hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{00}y_{01}$} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{01}y_{01}$} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{10}y_{01}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{11}y_{01}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline\hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{00}y_{10}$} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{01}y_{10}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{10}y_{10}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \multicolumn{2}{c|}{$x_{11}y_{10}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline\hline
\hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{00}y_{11}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \hspace{15pt} & \multicolumn{2}{c|}{$x_{01}y_{11}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline
\hspace{15pt} & \multicolumn{2}{c|}{$x_{10}y_{11}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\ \hline
\multicolumn{2}{|c|}{$x_{11}y_{11}$} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} & \hspace{15pt} \\
\hline
\end{tabular}
\end{center}
\begin{align*}
Z=XY=\of{\sum_{i=0}^{n-1}x_i2^{iw}}\of{\sum_{j=0}^{m-1}y_j2^{jw}}=\sum_{j=0}^{m-1}\of{\sum_{i=0}^{n-1}(x_iy_j)2^{w(i+j)}}\in\intco{0,2^{w(n+m)}}.
\end{align*}

\begin{algorithm}[H]
\caption{Single-Word Multiplication $x[i]\cdot y[i]$}
\BlankLine
\KwIn{\(x,y\in\intco{0,2^w}\)}
\KwOut{\(z=xy\in\intco{0,2^{2\cdot w}}\)}
\BlankLine
\Fn{\textnormal{\Call{Mul\_Single}{$x,y$}}}{
	$x_1,x_0\gets x_{[w:w/2]},x_{[w/2:0]}$\tcp*{$x=x_1\adjacent x_0$}
	$y_1,y_0\gets y_{[w:w/2]},y_{[w/2:0]}$\tcp*{$y=y_1\adjacent y_0$}
	\BlankLine
	$t_1,t_0\gets x_1y_0, x_0y_1$\tcp*{Cross Mul. $t_1,t_0\in\intco{0,2^w}$}
	\BlankLine
	\Comment{$x_1y_0+x_0y_1=t_12^w+t_0$, where $t_1\in\set{0,1}$ is carry}
	\BlankLine
	$t_0\gets t_1\boxplus t_0$\;
	$t_1\gets t_0 < t_1$\tcp*{$t_1\boxplus t_0 < t_1$}
	\BlankLine
	$z_1,z_0\gets x_1y_1,x_0y_0$\tcp*{$z_1,z_0\in\intco{0,2^w}$}
	$t\gets z_0$\;
	\BlankLine
	$z_0\gets z_0\boxplus(t_0\ll w/2)$\tcp*{$z_0=\sbr{x_0y_0 + (x_1y_0+x_0y_1)2^{w/2}}\bmod 2^w$}
	$z_1\gets z_1 + (t_1\ll w/2) + (t_0\gg w/2) + (z_0<t)$\tcp*{$z_1\in\intco{0,W}$}
	\Comment{$z_1=x_1y_1 + (t_0<t_1)2^{w/2} + \floor*{t_0/2^{w/2}} + $ (carry in line 9)}
	\BlankLine
	\Return $(z_1\ll w) + z_0$\tcp*{$z\gets z_1\parallel z_0\in\intco{0,2^{2w}}$}
}
\end{algorithm}

\begin{algorithm}[H]
\caption{Integer Multiplication in $\F_p$ (Operand Scanning Form)}
\BlankLine
\KwIn{\(X,Y\in\intco{0,p}\subseteq\intco{0,2^{wt}}\)\tcp*{$(w,t)=(32,8)$ or $(w,t)=(64,4)$ for secp256r1}}
\KwOut{\(Z=X\cdot Y\in\intco{0,p}\subseteq\intco{0,2^{wt}}\)}
\BlankLine
\For{$i=0$ \KwTo $t-1$}{
	$z[i]\gets 0$\tcp*{Initialization}
}
\For{$i=0$ \KwTo $t-1$}{
	$U\gets 0$\tcp*{$U\in\intco{0,2^{w/2}}$}
	\For{$j=0$ \KwTo $t-1$}{
		$UV\gets z[i+j]+x[i]\cdot y[j]+U$\tcp*{Inner Product}
		$z[i+j]\gets V$
	}
	$z[i+t]\gets U$
}
\Return $Z$
\end{algorithm}

\newpage
\section{Product Scanning (Comba)}










